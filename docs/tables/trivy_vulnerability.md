---
title: "Steampipe Table: trivy_vulnerability - Query Trivy Vulnerabilities using SQL"
description: "Allows users to query Trivy Vulnerabilities, providing insights into potential security issues within resources."
---

# Table: trivy_vulnerability - Query Trivy Vulnerabilities using SQL

Trivy is a comprehensive vulnerability scanner for offering visibility into potential security issues within containers and file systems. It identifies vulnerabilities within Operating Systems and application dependencies, providing a critical tool for security and DevOps professionals. Trivy helps to maintain the security posture of resources by identifying and providing details about known vulnerabilities.

## Table Usage Guide

The `trivy_vulnerability` table provides insights into potential vulnerabilities within resources. As a security or DevOps professional, use this table to explore and understand the vulnerabilities that exist within your environment, including their severity, package name, and current version. This table is a valuable tool for maintaining the security posture of your resources and ensuring compliance with security best practices.

**Important Notes**
- To scan files or images for vulnerabilities please see the `trivy_scan_vulnerability` table.

## Examples

### List all vulnerabilities
Explore which system vulnerabilities exist, their details, and when they were published, to better understand potential security risks and prioritize remediation efforts.

```sql
select
  name,
  title,
  published_date,
  description
from
  trivy_vulnerability
order by
  name;
```

### Vulnerabilities published in the last 7 days
Discover the segments that have been exposed to vulnerabilities in the past week. This allows you to understand recent threats and take appropriate security measures.

```sql
select
  name,
  title,
  published_date,
  description
from
  trivy_vulnerability
where
  published_date > now() - interval '7 days'
order by
  published_date desc;
```

### Vulnerabilities by severity
Analyze the severity of vulnerabilities within your system to understand the areas that require immediate attention. This can help prioritize security measures and allocate resources effectively.

```sql
select
  severity,
  count(*)
from
  trivy_vulnerability
group by
  severity
order by
  count desc;
```

### Vulnerabilities by Common Weakness Enumeration (CWE)
Explore which weaknesses are most common in your system by counting the occurrences of each Common Weakness Enumeration (CWE). This can help prioritize security efforts by identifying the most recurring vulnerabilities.

```sql
select
  cwe_id,
  count(*) as count,
  array_agg(v.name)
from
  trivy_vulnerability as v,
  jsonb_array_elements_text(cwe_ids) as cwe_id
group by
  cwe_id
order by
  count desc;
```

### 2022 CVEs for CWE-20 Improper Input Validation
Determine the areas in which potential vulnerabilities related to improper input validation have been identified in the year 2022. This can be useful for prioritizing and addressing security issues in your system.

```sql
select
  name,
  title,
  published_date,
  cwe_ids
from
  trivy_vulnerability
where
  name like 'CVE-2022-%'
  and cwe_ids ? 'CWE-20'
order by
  name;
```

### Vulnerability types (e.g. CVE) in the database
Explore the distribution of different types of vulnerabilities within your system to better understand the areas that require enhanced security measures. This can help prioritize your responses to potential threats.

```sql
select
  split_part(name, '-', 1) as vuln_type,
  count(*)
from
  trivy_vulnerability
group by
  vuln_type
order by
  count desc;
```

### Vulnerabilities with a National Vulnerability Database Qualitative Severity Rating > 7
Gain insights into potential vulnerabilities that have a high severity rating according to the National Vulnerability Database. This can be particularly useful for prioritizing security measures and addressing the most critical threats first.
Learn more about the [Qualitative Severity Rating Scale](https://www.first.org/cvss/v3.0/specification-document#Qualitative-Severity-Rating-Scale).


```sql
select
  name,
  severity,
  (cvss -> 'nvd' -> 'V3Score')::float as v3_score,
  title
from
  trivy_vulnerability
where
  (cvss -> 'nvd' -> 'V3Score')::float > 8
order by
  v3_score desc;
```