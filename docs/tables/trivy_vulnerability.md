# Table: trivy_vulnerability

Vulnerabilities detail the vulnerabilities affecting specific operating systems and packages.

To scan files or images for vulnerabilities please see the `trivy_scan_vulnerability` table.

## Examples

### List all vulnerabilities

```sql
select
  name,
  title,
  published_date,
  description
from
  trivy_vulnerability
order by
  name
```

### Vulnerabilities published in the last 7 days

```sql
select
  name,
  title,
  published_date,
  description
from
  trivy_vulnerability
where
  published_date > now() - interval '7 days'
order by
  published_date desc
```

### Vulnerabilities by severity

```sql
select
  severity,
  count(*)
from
  trivy_vulnerability
group by
  severity
order by
  count desc
```

### Vulnerabilities by Common Weakness Enumeration (CWE)

```sql
select
  cwe_id,
  count(*) as count,
  array_agg(v.name)
from
  trivy_vulnerability as v,
  jsonb_array_elements_text(cwe_ids) as cwe_id
group by
  cwe_id
order by
  count desc
```

### 2022 CVEs for CWE-20 Improper Input Validation

```sql
select
  name,
  title,
  published_date,
  cwe_ids
from
  trivy_vulnerability
where
  name like 'CVE-2022-%'
  and cwe_ids ? 'CWE-20'
order by
  name
```

### Vulnerability types (e.g. CVE) in the database

```sql
select
  split_part(name, '-', 1) as vuln_type,
  count(*)
from
  trivy_vulnerability
group by
  vuln_type
order by
  count desc
```

### Vulnerabilities with a National Vulnerability Database Qualitative Severity Rating > 7

Learn more about the [Qualitative Severity Rating Scale](https://www.first.org/cvss/v3.0/specification-document#Qualitative-Severity-Rating-Scale).

```sql
select
  name,
  severity,
  (cvss -> 'nvd' -> 'V3Score')::float as v3_score,
  title
from
  trivy_vulnerability
where
  (cvss -> 'nvd' -> 'V3Score')::float > 8
order by
  v3_score desc
```
