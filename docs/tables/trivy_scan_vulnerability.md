# Table: trivy_scan_vulnerability

Scan files and container images for vulnerabilities.

To list all vulnerability definitions use the `trivy_vulnerability` table instead.

## Examples

### Scan all targets defined in trivy.spc for vulnerabilities

```sql
select
  artifact_type,
  artifact_name,
  target,
  vulnerability_id,
  installed_version
from
  trivy_scan_vulnerability;
```

### Scan a specific directory for vulnerabilities

```sql
select
  target,
  vulnerability_id,
  installed_version
from
  trivy_scan_vulnerability
where
  artifact_type = 'filesystem'
  and artifact_name = '/Users/jane/src/steampipe';
```

### Scan a specific container image for vulnerabilities

```sql
select
  target,
  vulnerability_id,
  installed_version
from
  trivy_scan_vulnerability
where
  artifact_type = 'container_image'
  and artifact_name = 'turbot/steampipe';
```

### Count of vulnerabilities by artifact

```sql
select
  artifact_type,
  artifact_name,
  count(*)
from
  trivy_scan_vulnerability
group by
  artifact_type,
  artifact_name
order by
  count desc;
```

### All vulnerabilities for the libc6 package

```sql
select
  artifact_type,
  artifact_name,
  target,
  vulnerability_id,
  installed_version
from
  trivy_scan_vulnerability
where
  package_name = 'libc6'
order by
  artifact_type,
  artifact_name,
  target,
  vulnerability_id;
```

### Vulnerabilities by package

```sql
select
  class,
  type,
  package_name,
  count(*),
  array_agg(vulnerability_id)
from
  trivy_scan_vulnerability
group by
  class,
  type,
  package_name
order by
  count desc;
```
